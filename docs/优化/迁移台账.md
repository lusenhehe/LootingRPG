# 迁移台账（Phase 0 起）

> 记录规则：每次迁移必须记录 **来源文件 -> 新文件 -> 删除时间**，并标注状态。

## 字段说明
- **状态**：`规划中` / `迁移中` / `已切换` / `已删除`
- **删除时间**：计划删除日期或实际删除日期
- **验证**：至少包含一种（typecheck/build/smoke/人工回归）

## 台账记录

| 编号 | 领域 | 来源文件 | 新文件（目标） | 状态 | 负责人 | 删除时间 | 验证 | 备注 |
|---|---|---|---|---|---|---|---|---|
| MIG-001 | battle | `src/logic/battle/index.ts` | `src/domains/battle/services/*` + `src/domains/battle/reducers/*` | 迁移中 | Agent | 2026-03-31（计划） | build + check:orphan | 已迁移 session 主流程，reducers 待补齐 |
| MIG-002 | inventory | `src/logic/equipment.ts` | `src/domains/inventory/services/equipment.ts` | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | 调用已迁移并删除旧入口 |
| MIG-003 | inventory | `src/logic/equipmentUtils.ts` | `src/domains/inventory/services/equipmentTotals.ts` | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | 已完成迁移并删除旧入口 |
| MIG-004 | inventory | `src/logic/enhancement.ts` | `src/domains/inventory/services/enhancement.ts` | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | 调用已迁移，旧入口删除 |
| MIG-005 | player | `src/logic/playerStats.ts` | `src/domains/player/services/recalculatePlayerStats.ts` | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | 调用已迁移并删除旧入口 |
| MIG-006 | player | `src/logic/stats/playerStats.ts` | `src/domains/player/model/combat.ts` | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | 调用已迁移，旧入口删除 |
| MIG-007 | map | `src/config/map/ChapterData.ts` | `src/domains/map/model/chapters.ts` | 迁移中 | Agent | 2026-03-25（计划） | build + check:orphan | 已建立 domains 新实现，旧入口改为兼容导出 |
| MIG-008 | map | `src/logic/mapProgress.ts` | `src/domains/map/services/progress.ts` | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | 调用已迁移并删除旧入口 |
| MIG-026 | map | `src/logic/mapUtils.ts` | `src/domains/map/services/nodeLookup.ts` | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | 调用已切换至 domains，旧入口删除 |
| MIG-027 | inventory | `src/logic/inventory/actions.ts` | `src/domains/inventory/services/actions.ts` | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | 调用已迁移并删除旧入口 |
| MIG-028 | inventory | `src/logic/inventory/autoSell.ts` | `src/domains/inventory/services/autoSell.ts` | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | 调用已迁移并删除旧入口 |
| MIG-029 | inventory | `src/logic/inventory.ts` | `src/domains/inventory/services/quickSell.ts` | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | 调用已迁移并删除旧入口 |
| MIG-030 | monster | `src/logic/monsters/config.ts` | `src/domains/monster/config.ts` | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | 调用已迁移到 domains，旧入口删除 |
| MIG-031 | monster | `src/logic/monsters/lore.ts` | `src/domains/monster/lore.ts` | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | 调用已迁移到 domains，旧入口删除 |
| MIG-032 | monster | `src/logic/monsters/catalog.ts` | `src/domains/monster/catalog.ts` | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | 调用已迁移到 domains，旧入口删除 |
| MIG-048 | monster | `src/domains/monster/{catalog.ts,lore.ts}` | `src/domains/monster/services/monsterCatalog.ts` | 已删除/已新增 | Agent | 2026-02-26（实际） | check:orphan + build | 收敛服务，旧文件删除，新服务提供怪物列表及本地化 || MIG-033 | battle | `src/logic/battle/index.ts` | `src/domains/battle/services/session.ts` | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | 调用已迁移并删除旧入口 |
| MIG-034 | battle | `src/logic/stats/monsterScaling.ts` | `src/domains/battle/services/monsterScaling.ts` | 迁移中 | Agent | 2026-03-31（计划） | build + check:orphan | 已建立 domains 实现，旧入口改兼容导出 |
| MIG-035 | battle | `src/logic/stats/monsterStats.ts` | `src/domains/battle/services/monsterStats.ts` | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | 调用已迁移，旧入口删除 |
| MIG-036 | app | `src/logic/gameState/globalState.ts` | `src/app/state/globalState.ts` | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | 调用已迁移，旧入口删除 |
| MIG-037 | app | `src/logic/gameState/inventoryState.ts` | `src/app/state/inventoryState.ts` | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | 调用已迁移，旧入口删除 |
| MIG-038 | app | `src/logic/gameState/index.ts` | `src/app/state/index.ts` | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | 调用已迁移并删除旧入口 |
| MIG-039 | app | `src/logic/gameState/stateManager.ts` | `src/app/state/stateManager.ts` | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | 调用已迁移，旧入口删除 |
| MIG-040 | infra | `src/logic/i18n/labels.ts` | `src/infra/i18n/labels.ts` | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | 调用已迁移并删除旧入口 |
| MIG-041 | config | `src/config/game/equipment.ts` | `src/domains/game/config/equipment.ts` | 规划中 | TBC | 2026-03-29（计划） | - | 推迟到后续，当前保留旧路径为稳定来源 |
| MIG-042 | config | `src/config/game/progression.ts` | `src/domains/game/config/progression.ts` | 迁移中 | Agent | 2026-03-29（计划） | build + check:orphan | 已建立 domains 入口（当前仍以旧路径为稳定来源） |
| MIG-009 | app | `src/App.tsx`（编排职责） | `src/app/AppShell.tsx` + `src/app/useGameOrchestrator.ts` | 已切换 | Agent | 2026-02-25（实际） | build + check:orphan | App 已收敛为壳组件，编排职责迁移完成 |
| MIG-010 | docs | `docs/优化/模块清单.md` | `docs/architecture/module-inventory.md`（可选） | 规划中 | TBC | 2026-04-10（计划） | - | 稳定后迁到统一架构文档目录 |
| MIG-011 | cleanup | `src/components/game/BaseCard.tsx` | -（无替代，确认无引用后删除） | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | Phase0.5 清理 |
| MIG-012 | cleanup | `src/components/game/PlayerInfoBadge.tsx` | -（无替代，确认无引用后删除） | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | Phase0.5 清理 |
| MIG-013 | cleanup | `src/components/game/tabs/BattleLogTab.tsx` | -（无替代，确认无引用后删除） | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | Phase0.5 清理 |
| MIG-014 | cleanup | `src/components/ui/ActionButton.tsx` | -（无替代，确认无引用后删除） | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | Phase0.5 清理 |
| MIG-015 | cleanup | `src/components/ui/StatItem.tsx` | -（无替代，确认无引用后删除） | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | Phase0.5 清理 |
| MIG-016 | cleanup | `src/config/content/equipments.ts` | -（由 `config/game/equipment.ts` 已覆盖） | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | Phase0.5 清理 |
| MIG-017 | cleanup | `src/config/game/battleConfig.ts` | -（无引用后删除） | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | Phase0.5 清理 |
| MIG-018 | cleanup | `src/config/game/traitBehaviorConfig.ts` | -（无引用后删除） | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | Phase0.5 清理 |
| MIG-019 | cleanup | `src/config/map/chapters.ts` | -（以 `config/map/ChapterData.ts` 为主） | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | Phase0.5 清理 |
| MIG-020 | cleanup | `src/config/map/mapTypes.ts` | -（无引用后删除） | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | Phase0.5 清理 |
| MIG-021 | cleanup | `src/config/ui/mapNode.ts` | -（无引用后删除） | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | Phase0.5 清理 |
| MIG-022 | cleanup | `src/logic/gameState/mapState.ts` | -（无引用后删除） | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | Phase0.5 清理 |
| MIG-023 | cleanup | `src/logic/gameState/playerState.ts` | -（无引用后删除） | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | Phase0.5 清理 |
| MIG-024 | cleanup | `src/logic/monsterGeneration.ts` | -（无引用后删除） | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | Phase0.5 清理 |
| MIG-025 | cleanup | `src/logic/playerCommands.ts` | -（无引用后删除） | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | Phase0.5 清理 |
| MIG-043 | player | `src/logic/uiHelpers.ts` | `src/domains/player/services/derivedStats.ts` | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | 调用已迁移并删除旧入口 |
| MIG-044 | battle | `src/logic/stats/monsterScaling.ts`（调用侧） | `src/domains/battle/services/monsterScaling.ts` | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | 调用已迁移并删除旧入口 |
| MIG-045 | battle/app | `src/logic/battle/index.ts`（调用侧） | `src/domains/battle/services/session.ts` | 已删除 | Agent | 2026-02-25（实际） | check:orphan + build | 调用已迁移并删除旧入口 |
| MIG-046 | app | `src/App.tsx`（页面路由/鉴权分支） | `src/app/AppShell.tsx` | 已切换 | Agent | 2026-02-25（实际） | build + check:orphan | 登录页与游戏页装配迁移到 AppShell |
| MIG-047 | app | `src/App.tsx`（业务编排回调） | `src/app/useGameOrchestrator.ts` | 已切换 | Agent | 2026-02-25（实际） | build + check:orphan | 战斗/背包/地图编排回调迁移到 orchestrator hook |

---

## 使用规范（强制）
1. 迁移开始前先加一条记录，禁止“先改后补”。
2. 状态更新必须随 PR 一起提交。
3. 当状态改为 `已删除` 时，删除时间填“实际删除日期”。
4. 未登记台账的迁移 PR 一律不合并。
