# 模块现状清单（Phase 0）

> 目标：停止技术债继续增长；明确哪些模块保留、合并、删除、待迁移。
> 版本：v1（基于当前仓库快照）

## 标记说明
- **保留**：当前主流程在用，短期不动结构，仅做必要优化。
- **合并**：存在重复语义或平行实现，后续并入统一模块。
- **删除**：历史遗留/样例/失效路径，确认无依赖后移除。
- **待迁移**：功能仍需，但实现将迁入新分层（`domains/*`）后再删旧文件。

## A. 应用装配与入口

| 模块 | 状态 | 说明 | 下一步 |
|---|---|---|---|
| `src/main.tsx` | 保留 | 应用启动入口，职责明确。 | 保持轻量，只做初始化与挂载。 |
| `src/App.tsx` | 待迁移 | 当前承担状态组装+流程编排，职责偏重。 | 后续拆分为 `app/` 组装层 + 域 hooks。 |
| `src/i18n.ts` | 保留 | i18n 初始化入口。 | 可迁至 `infra/i18n` 并保留兼容导出。 |

## B. 组件层（UI）

| 模块 | 状态 | 说明 | 下一步 |
|---|---|---|---|
| `src/components/auth/*` | 保留 | 登录流程仍在主链路。 | 与 profile 领域契约化。 |
| `src/components/game/GameScreen.tsx` | 保留 | 页面骨架主入口。 | 继续收敛为纯展示+事件转发。 |
| `src/components/game/GamePanel.tsx` | 待迁移 | 承担 tab 编排，仍有跨域 props 压力。 | 分拆为 map/inventory/forge/codex 容器。 |
| `src/components/game/PlayerPanel.tsx` | 保留 | 信息展示组件，变更风险低。 | 仅允许 UI bugfix。 |
| `src/components/game/tabs/*` | 待迁移 | 多 tab 逻辑逐步域化。 | 分别迁入 `domains/*/ui`。 |
| `src/components/ui/TabButton.tsx` | 保留 | 通用 UI 原子组件。 | 归入 `shared/ui`。 |

## C. 业务逻辑（logic）

| 模块 | 状态 | 说明 | 下一步 |
|---|---|---|---|
| `src/logic/battle/index.ts` | 待迁移 | 战斗主流程核心仍在使用。 | 拆为 `domains/battle/services + reducers`。 |
| `src/logic/inventory/*` | 待迁移 | 背包动作较多，已形成域。 | 迁入 `domains/inventory`，减少 App 直连。 |
| `src/logic/gameState/*` | 合并 | 状态初始化/分片接口有重叠可能。 | 合并为统一 `model/state` 出口。 |
| `src/logic/mapProgress.ts` | 保留 | 地图进度工具函数价值高。 | 后续迁入 `domains/map/services`。 |
| `src/logic/mapUtils.ts` | 合并 | 与 mapProgress 语义可能重复。 | 与 map 领域服务合并。 |
| `src/logic/playerStats.ts` + `src/logic/stats/playerStats.ts` | 合并 | 同名语义重叠风险高。 | 保留一套“运行时口径”。 |
| `src/logic/stats/monsterStats.ts` + `monsterScaling.ts` | 保留 | 数值逻辑可继续复用。 | 迁入 battle/map 领域并补测试。 |
| `src/logic/equipment.ts` + `equipmentUtils.ts` + `enhancement.ts` | 合并 | 装备相关函数分散。 | 收敛为 `domains/inventory/services/equipment`。 |
| `src/logic/monsters/*` | 保留 | 配置访问与图鉴信息仍需要。 | 后续拆分 config 读层与业务层。 |
| `src/logic/uiHelpers.ts` | 待迁移 | 介于 UI 与业务之间的过渡模块。 | 迁移后删除，避免跨层 helper。 |

## D. 配置与内容（config）

| 模块 | 状态 | 说明 | 下一步 |
|---|---|---|---|
| `src/config/content/*` | 保留 | 资源与 schema 核心来源。 | 统一 schema 校验与版本字段。 |
| `src/config/map/*` | 合并 | TS/JSON 双轨与命名并存。 | 统一单一来源（建议 TS 导出）。 |
| `src/config/game/*` | 保留 | 进程参数与规则配置。 | 按域拆分子配置并补注释。 |
| `src/config/ui/*` | 待迁移 | 与 map/game 配置可能重叠。 | 归并到 `shared/ui` 或域内 UI config。 |
| `src/config/themes/*` | 保留 | 主题系统可独立维护。 | 迁入 `shared/theme`。 |
| `src/config/runtime/storage.ts` | 保留 | 存储 key 等基础能力。 | 升级为 `infra/storage`。 |

## E. 类型与国际化

| 模块 | 状态 | 说明 | 下一步 |
|---|---|---|---|
| `src/types/game.ts` | 待迁移 | 核心类型文件仍较大、跨域。 | 分解为 `domains/*/model` + `shared/types`。 |
| `src/types/assets.d.ts` | 保留 | 构建类型声明。 | 保持最小化。 |
| `src/locales/*` | 保留 | 语言资源主来源。 | 建立 keys 维护规范。 |

## F. 工具、文档与平台目录

| 模块 | 状态 | 说明 | 下一步 |
|---|---|---|---|
| `tools/level-editor/*` | 待迁移 | 子工具与主应用边界待明确。 | 单独定义 tool 接口与发布策略。 |
| `android/*` | 保留 | 多端目标平台目录。 | 独立维护，不混入业务逻辑。 |
| `docs/*` | 保留 | 需要从“说明文档”升级为“可执行文档”。 | 增加台账与里程碑关联。 |
| `saves/*` | 删除 | 仓库不应长期保留个人样例存档。 | 保留 `.gitkeep` 或示例模板。 |

---

## 立即执行项（Phase 0 周内）
1. 将本清单纳入每周巡检更新（状态变化必须可追踪）。
2. 先从“高收益合并项”开工：`playerStats`、`equipment`、`map config`。
3. 删除项执行前，必须在迁移台账中先登记并确认“无引用证明”。
